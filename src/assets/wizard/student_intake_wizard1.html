<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Intake Form - Wizard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .form-container {
            max-width: 800px;
            margin: 2rem auto;
            background-color: #fff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-light">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Main App Component
        const App = () => {
            const [step, setStep] = useState(1);
            const [formData, setFormData] = useState({
                personal_details: {
                    email: '',
                    full_name: '',
                    phone_number: '',
                    graduation_stream_and_year: '',
                    current_status: 'Full-time Aspirant',
                    present_location: ''
                },
                preparation_background: {
                    preparing_since: '',
                    target_year: '2026',
                    number_of_attempts: '0',
                    earlier_attempts: []
                },
                academic_preparation: {
                    last_attempt_prelims_score: '',
                    prior_coaching: { has_coached: 'No', institute: '' },
                    place_of_preparation: [],
                    prior_mentorship: { has_mentorship: 'No', details: '' },
                    mains_optional_subject: ''
                },
                mains_subject_confidence: {
                    polity: 'Moderate', modern_history: 'Moderate', geography: 'Moderate',
                    economy: 'Moderate', environment: 'Moderate', technology: 'Moderate',
                    governance: 'Moderate', society: 'Moderate', ethics: 'Moderate',
                    social_justice: 'Moderate', international_relations: 'Moderate',
                    disaster_management: 'Moderate', security: 'Moderate',
                    anci_med_art_and_culture: 'Moderate', csat: 'Moderate'
                },
                csat_weakness: [],
                study_habits_and_discipline: {
                    time_use_and_habits: {
                        answer_writing: 'Weekly', essay_writing: 'Weekly',
                        newspaper_reading: 'Daily', current_affairs: 'Daily'
                    },
                    average_daily_study_hours: []
                },
                challenges_and_mentorship_needs: {
                    biggest_challenges: '',
                    specific_support_needed: '',
                    additional_information: ''
                }
            });

            const nextStep = () => setStep(prev => prev + 1);
            const prevStep = () => setStep(prev => prev - 1);

            const handleChange = (section, field, subfield = null) => e => {
                const { type, value, checked } = e.target;
                
                setFormData(prev => {
                    const newFormData = { ...prev };
                    let sectionData = newFormData[section];

                    if (type === 'checkbox') {
                        const newArray = sectionData[field] ? [...sectionData[field]] : [];
                        if (checked) {
                            newArray.push(value);
                        } else {
                            const index = newArray.indexOf(value);
                            if (index > -1) {
                                newArray.splice(index, 1);
                            }
                        }
                        sectionData[field] = newArray;
                    } else if (subfield) {
                        sectionData[field] = { ...sectionData[field], [subfield]: value };
                    } else {
                        sectionData[field] = value;
                    }
                    
                    return { ...newFormData, [section]: sectionData };
                });
            };

            const handleSubmit = () => {
                console.log("Final Form Data:", formData);
                nextStep(); // Move to success page
            };

            const renderStep = () => {
                switch (step) {
                    case 1: return <Step1 data={formData.personal_details} handleChange={handleChange} nextStep={nextStep} />;
                    case 2: return <Step2 data={formData.preparation_background} handleChange={handleChange} nextStep={nextStep} prevStep={prevStep} />;
                    case 3: return <Step3 data={formData.academic_preparation} handleChange={handleChange} nextStep={nextStep} prevStep={prevStep} />;
                    case 4: return <Step4 data={formData.mains_subject_confidence} handleChange={handleChange} nextStep={nextStep} prevStep={prevStep} />;
                    case 5: return <Step5 data={{...formData.csat_weakness, ...formData.study_habits_and_discipline}} handleChange={handleChange} nextStep={nextStep} prevStep={prevStep} />;
                    case 6: return <Step6 data={formData.challenges_and_mentorship_needs} handleChange={handleChange} nextStep={nextStep} prevStep={prevStep} />;
                    case 7: return <Review data={formData} prevStep={prevStep} handleSubmit={handleSubmit} />;
                    case 8: return <Success />;
                    default: return <div>Form Complete</div>;
                }
            };
            
            const totalSteps = 7;
            const progress = (step <= totalSteps) ? (step / totalSteps) * 100 : 100;

            return (
                <div className="form-container">
                    {step <= totalSteps && (
                        <header className="mb-4">
                            <h3>Step {step} of {totalSteps}</h3>
                            <div className="progress">
                                <div className="progress-bar" role="progressbar" style={{width: `${progress}%`}} aria-valuenow={progress} aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </header>
                    )}
                    {renderStep()}
                </div>
            );
        };

        // Step Components
        const Step1 = ({ data, handleChange, nextStep }) => (
            <div>
                <h2>Personal Details</h2>
                <div className="form-group">
                    <label>Full Name</label>
                    <input type="text" className="form-control" value={data.full_name} onChange={handleChange('personal_details', 'full_name')} />
                </div>
                <div className="form-group">
                    <label>Email</label>
                    <input type="email" className="form-control" value={data.email} onChange={handleChange('personal_details', 'email')} />
                </div>
                <div className="form-group">
                    <label>Phone Number</label>
                    <input type="tel" className="form-control" value={data.phone_number} onChange={handleChange('personal_details', 'phone_number')} />
                </div>
                <div className="form-group">
                    <label>Graduation Stream & Year</label>
                    <input type="text" className="form-control" value={data.graduation_stream_and_year} onChange={handleChange('personal_details', 'graduation_stream_and_year')} />
                </div>
                <div className="form-group">
                    <label>Current Status</label>
                    <select className="form-control" value={data.current_status} onChange={handleChange('personal_details', 'current_status')}>
                        <option>Final Year Student</option>
                        <option>Full-time Aspirant</option>
                        <option>Working Professional</option>
                    </select>
                </div>
                <div className="form-group">
                    <label>Present Location (City/State)</label>
                    <input type="text" className="form-control" value={data.present_location} onChange={handleChange('personal_details', 'present_location')} />
                </div>
                <button className="btn btn-primary" onClick={nextStep}>Next</button>
            </div>
        );

        const Step2 = ({ data, handleChange, nextStep, prevStep }) => (
            <div>
                <h2>Preparation Background</h2>
                <div className="form-group">
                    <label>Preparing Since (Month & Year)</label>
                    <input type="text" className="form-control" value={data.preparing_since} onChange={handleChange('preparation_background', 'preparing_since')} />
                </div>
                <div className="form-group">
                    <label>Target Year</label>
                    <select className="form-control" value={data.target_year} onChange={handleChange('preparation_background', 'target_year')}>
                        <option>2026</option>
                        <option>2027</option>
                        <option>2028</option>
                    </select>
                </div>
                <div className="form-group">
                    <label>Number of Attempts So Far</label>
                    <select className="form-control" value={data.number_of_attempts} onChange={handleChange('preparation_background', 'number_of_attempts')}>
                        <option>0</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5+</option>
                    </select>
                </div>
                <div className="d-flex justify-content-between">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-primary" onClick={nextStep}>Next</button>
                </div>
            </div>
        );
        
        const Step3 = ({ data, handleChange, nextStep, prevStep }) => (
            <div>
                <h2>Academic Preparation</h2>
                <div className="form-group">
                    <label>Last Attempt Prelims Score (GS/CSAT)</label>
                    <input type="text" className="form-control" value={data.last_attempt_prelims_score} onChange={handleChange('academic_preparation', 'last_attempt_prelims_score')} />
                </div>
                <div className="form-group">
                    <label>Mains Optional Subject (Chosen or Exploring)</label>
                    <input type="text" className="form-control" value={data.mains_optional_subject} onChange={handleChange('academic_preparation', 'mains_optional_subject')} />
                </div>
                 <div className="form-group">
                    <label>Place of Preparation</label>
                    <div>
                        {['City + Offline Coaching', 'Home + Online Coaching', 'City + Online Coaching', 'Other'].map(item => (
                            <div className="form-check" key={item}>
                                <input className="form-check-input" type="checkbox" value={item} checked={data.place_of_preparation.includes(item)} onChange={handleChange('academic_preparation', 'place_of_preparation')} />
                                <label className="form-check-label">{item}</label>
                            </div>
                        ))}
                    </div>
                </div>
                <div className="d-flex justify-content-between">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-primary" onClick={nextStep}>Next</button>
                </div>
            </div>
        );

        const Step4 = ({ data, handleChange, nextStep, prevStep }) => {
        const subjects = [
            'polity', 'modern_history', 'geography', 'economy', 'environment', 'technology',
            'governance', 'society', 'ethics', 'social_justice', 'international_relations',
            'disaster_management', 'security', 'anci_med_art_and_culture', 'csat'
        ];
        const confidenceLevels = ['Not Started', 'Very Weak', 'Weak', 'Moderate', 'Strong', 'Very Strong'];
        
        return (
            <div>
                <h2>Mains Subject-wise Confidence</h2>
                {subjects.map(subject => (
                    <div className="form-group" key={subject}>
                        <label className="text-capitalize d-block">{subject.replace(/_/g, ' ')}</label>
                        <div>
                            {confidenceLevels.map(level => (
                                <div className="form-check form-check-inline" key={level}>
                                    <input
                                        className="form-check-input"
                                        type="radio"
                                        name={subject}
                                        value={level}
                                        checked={data[subject] === level}
                                        onChange={handleChange('mains_subject_confidence', subject)}
                                    />
                                    <label className="form-check-label">{level}</label>
                                </div>
                            ))}
                        </div>
                    </div>
                ))}
                <div className="d-flex justify-content-between mt-4">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-primary" onClick={nextStep}>Next</button>
                </div>
            </div>
        );
    };

        const Step5 = ({ data, handleChange, nextStep, prevStep }) => (
            <div>
                <h2>CSAT & Study Habits</h2>
                <div className="form-group">
                    <label>CSAT Weakness (If Applicable)</label>
                    <div>
                        {['Arithmetic', 'Comprehension', 'Reasoning', 'Time Management', 'Other'].map(item => (
                            <div className="form-check" key={item}>
                                <input className="form-check-input" type="checkbox" value={item} checked={data.csat_weakness && data.csat_weakness.includes(item)} onChange={handleChange('csat_weakness', 'csat_weakness')} />
                                <label className="form-check-label">{item}</label>
                            </div>
                        ))}
                    </div>
                </div>
                <div className="form-group">
                    <label>Average Daily Study Hours</label>
                    <div>
                        {['< 4 hours', '4-6 hours', '6-8 hours', '8+ hours', 'Other'].map(item => (
                            <div className="form-check" key={item}>
                                <input className="form-check-input" type="checkbox" value={item} checked={data.average_daily_study_hours.includes(item)} onChange={handleChange('study_habits_and_discipline', 'average_daily_study_hours')} />
                                <label className="form-check-label">{item}</label>
                            </div>
                        ))}
                    </div>
                </div>
                <div className="d-flex justify-content-between">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-primary" onClick={nextStep}>Next</button>
                </div>
            </div>
        );

        const Step6 = ({ data, handleChange, nextStep, prevStep }) => (
            <div>
                <h2>Challenges & Mentorship Needs</h2>
                <div className="form-group">
                    <label>What are your biggest challenges in UPSC preparation?</label>
                    <textarea className="form-control" rows="3" value={data.biggest_challenges} onChange={handleChange('challenges_and_mentorship_needs', 'biggest_challenges')}></textarea>
                </div>
                <div className="form-group">
                    <label>What specific support do you seek from mentorship?</label>
                    <textarea className="form-control" rows="3" value={data.specific_support_needed} onChange={handleChange('challenges_and_mentorship_needs', 'specific_support_needed')}></textarea>
                </div>
                <div className="form-group">
                    <label>Anything else that you want to add or share?</label>
                    <textarea className="form-control" rows="3" value={data.additional_information} onChange={handleChange('challenges_and_mentorship_needs', 'additional_information')}></textarea>
                </div>
                <div className="d-flex justify-content-between">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-primary" onClick={nextStep}>Review</button>
                </div>
            </div>
        );

        const Review = ({ data, prevStep, handleSubmit }) => (
            <div>
                <h2>Review Your Information</h2>
                {Object.entries(data).map(([section, sectionData]) => (
                    <div key={section} className="card mb-3">
                        <div className="card-header text-capitalize">{section.replace(/_/g, ' ')}</div>
                        <ul className="list-group list-group-flush">
                            {Object.entries(sectionData).map(([field, value]) => (
                                <li key={field} className="list-group-item">
                                    <strong className="text-capitalize">{field.replace(/_/g, ' ')}:</strong> 
                                    <span className="pl-2">{typeof value === 'object' ? JSON.stringify(value) : value.toString()}</span>
                                </li>
                            ))}
                        </ul>
                    </div>
                ))}
                <div className="d-flex justify-content-between">
                    <button className="btn btn-secondary" onClick={prevStep}>Back</button>
                    <button className="btn btn-success" onClick={handleSubmit}>Submit</button>
                </div>
            </div>
        );
        
        const Success = () => (
            <div className="text-center">
                <h2 className="mb-3">Thank You!</h2>
                <p>Your information has been submitted successfully.</p>
                <p>The form data has been logged to the browser's console.</p>
            </div>
        );


        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
