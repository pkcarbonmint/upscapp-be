<html>

<head>
    <style>
        @page {
            size: A4;
            margin: 0.5in;
        }

        @media print {
            .payment-info {
                break-before: auto;
                break-inside: avoid;
            }
        }

        body {
            font-family: 'Open Sans';
            font-size: 10px;
            margin: 0;
            padding: 0;
        }

        .title {
            text-align: center;
            margin-top: -10px;
        }

        .title p {
            font-weight: 600;

        }

        .date {
            font-weight: 600;
            text-align: right;
            font-size: 13px;
        }

        .addrs {
            text-align: left;
            font-size: 13px;
        }

        table,
        tr {
            border: 1px solid black;
            border-radius: 3%;
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            text-align: right;
            padding: 5px;
            word-wrap: break-word;
            word-break: break-word;
            /* Break long words if necessary */
            white-space: normal;
            overflow-wrap: break-word;
            font-size: 13px;
            color: rgb(47, 46, 46);
            font-weight: 500;
            border: 1px solid black;/
        }

        tr {
            text-align: right;
            padding: 5px;
        }

        .purchase-details td {
            padding: 10px 5px;
            /* Adjusts padding for each cell to add space at the top of rows */
        }

        .purchase-summary td {
            padding: 5px;
            /* Adds padding inside the summary cells */
        }

        .purchase-summary td:nth-child(1) {
            padding-left: 5px;
            /* 5px gap on the left side */
        }

        .purchase-summary td:nth-child(2) {
            text-align: right;
            padding-right: 5px;
            /* 5px gap on the right side */
        }

        .lighter {
            font-weight: 400;
            /* Lighter font weight */
            font-style: italic;
        }

        .thanks {
            float: left;
            font-size: 13px;
            margin-top: 5px;
            padding-bottom: 20px;
            margin-bottom: 20px;

        }

        .footer {
            position: absolute;
            bottom: 0;
            width: 100%;

            text-align: center;
            color: #5F6D7E;
            padding: 10px;
        }

        .pay {
            font-weight: 600;
            font-size: 14px;
        }

        .course-info {
            font-weight: 500;
            font-size: 14px;
        }

        .info {
            font-size: 13px;
            font-weight: 500;
        }

        .payment-info {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            /* Makes the container take full page height */
        }

        .pay-container {
            display: flex;
            flex-direction: column;
            /* Ensures each entry appears below the other */
            text-align: right;
            /* Aligns text to the right */
            padding-bottom: 15px;
            /* Adds spacing between entries */
            max-width: 70%;
            /* Prevents content from exceeding bounds */
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .payment p,

        .thanks p,
        .footer p {
            margin: 5px 0;
        }

        .footer p {
            font-size: 11px;
        }

        .thanks p {
            font-size: 12px;
        }

        hr {
            margin: 5px 0;
        }
    </style>

</head>

<body>
    <div>
        <div class="title">
            <img style="width: 40px; height: 40px;" src="{{ laex_icon }}" class="laex-icon" alt="La Excellence Icon">
            <p style="font-weight: 600; font-size: 16px;">Payment Receipt</p>

        </div>
        <div class="date">
            <p>Receipt Id: {{tx.id}}</p>
            <p>Date: {{date}}</p>

        </div>
        <div class="addrs">
            <p style="font-weight: 600; font-size: 16px;">Received From</p>
            <p>{{username}}</p>
            <p>Phone: {{ph_no}}</p>
            <p>Email: {{email}}</p>

        </div>

        <div class="payment-info">
            <div class="payment">
                <p style="font-weight: 600; font-size: 16px; margin-bottom: 10px; margin-top: 15px;"> Payment Details
                </p>

                <hr>
                <div style="display: flex; justify-content: space-between;">
                    <p class="info">Amount paid *</p>
                    <p class="pay">Rs. {{ indian_format(tx.amount // 100) }}</p>

                </div>
                <hr>
                <div style="display: flex; justify-content: space-between;">
                    <p class="info">Paid on</p>
                    <p class="pay">{{date}}</p>
                </div>
                <hr>
                <div style="display: flex; justify-content: space-between;">
                    <p class="info">Payment method</p>
                    <p class="pay">{{tx.payment_mode}}</p>
                </div>
                <hr>
                <div style="display: flex; justify-content: space-between;">
                    <p class="info"> Payment Status</p>
                    <p class="pay">{{tx.tx_status}}</p>
                </div>
                <hr>
                <div style="display: flex; justify-content: space-between;">
                    <p class="info">Reference</p>
                    <p class="pay">{{tx.tx_id}}</p>
                </div>
                <hr>
                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <p class="info">Course and Installment</p>
                    <div class="pay-container">
                        {% for purchase, offering_name, prod_name, prod_code in purchases %}
                        {% if purchase.purchase_type == 'BUY' %}
                        {% if purchase.purchase_installments %}
                        {% for installment in purchase.purchase_installments %}
                        {% if installment.transaction_id == receipt_id %}
                        <p class="course-info">
                            Rs.{{indian_format(installment.installment_amount)}} paid for Installment ID {{
                            installment.id }},
                            due on {{ format_date(installment.installment_date) }}, for {{ offering_name }},
                            {{prod_name}}, {{prod_code}}.
                        </p>
                        {% endif %}
                        {% endfor %}
                        {% else %}
                        <p class="course-info">Rs.{{indian_format(purchase.total_amount)}} paid for {{ offering_name
                            }},{{prod_name}},{{prod_code}}.
                        </p>
                        {% endif %}
                        {% else %}
                        <p class="course-info">Rs.{{indian_format(purchase.total_amount)}} paid for booking {{
                            offering_name }}, {{prod_name}}, {{prod_code}}</p>
                        {% endif %}
                        {% endfor %}

                    </div>


                </div>
                <hr>
            </div>
            <div class="thanks">
                <p>* Amount mentioned is inclusive of GST.</p>
                <p>Legal entity: {{legalentity_name}}</p>
                <p>Date-time recorded: {{tx_created}}</p>
                {% if tx.payment_mode == 'PAYMENT_LINK' %}
                <p>Recorded by user: Link-based</p>
                {% else %}
                <p>
                    Recorded by user:
                    {{ paid_to_user.full_name }}
                    {%- if paid_to_user.phone_number %}, {{ paid_to_user.phone_number }}{% endif %}
                    {%- if paid_to_user.email %}, {{ paid_to_user.email }}{% endif %}
                </p>
                {% endif %}
                <p style="margin-top: 50px; font-size: 15px;">Thanks for the payment.</p>
                <p style="margin-top: 13px; font-size: 15px;"> La Excellence</p>
            </div>
        </div>
        <div class="footer">
            <p>La Excellence Edu Services Private Limited, 302, 3rd Floor, SYNo58-60, Guttala Madhapur,
                Serilingampally,
                Hyderabad Rangareddy, Telangana, 500081, India</p>
            <!-- <p>GSTN: 36AAFCL0280P1Z6</p> -->

            <p style="margin-top: 10px;">This is electronic receipt and does not require signature.</p>
        </div>
    </div>
    <!-- {% if pur_installments_info %}
    <div style="page-break-before: always;">
        <p style="font-weight: 600; font-size: 16px;">Annexture (Installment Details)</p>


        {% for data in purchase_installments %}
        {% set offering_name = data.offering_name %}
        {% set pur_installments = data.installments %}
        {% if pur_installments %}
        <p style="font-weight: 500; font-size: 14px;">{{offering_name}}</p>

        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 2px solid black;">
            <thead>
                <tr style="background-color: #f2f2f2;">
                    <th style="border: 1px solid black; padding: 8px; font-size: 15px; font-weight: bold;">Installment
                        ID
                    </th>
                    <th style="border: 1px solid black; padding: 8px; font-size: 15px; font-weight: bold;">Installment
                        Date
                    </th>
                    <th style="border: 1px solid black; padding: 8px; font-size: 15px; font-weight: bold;">Installment
                        Amount
                    </th>
                    <th style="border: 1px solid black; padding: 8px; font-size: 15px; font-weight: bold;">Installment
                        Status</th>
                </tr>
            </thead>
            <tbody>
                {% for installment in pur_installments %}
                <tr>
                    <td style="border: 1px solid black; padding: 8px;">{{ installment.id }}</td>
                    <td style="border: 1px solid black; padding: 8px;">{{ format_date(installment.installment_date) }}
                    </td>
                    <td style="border: 1px solid black; padding: 8px;">{{ installment.installment_amount }}</td>
                    {% if installment.installment_status == "COMPLETED" %}
                    <td style="border: 1px solid black; padding: 8px;">Paid</td>
                    {% else %}
                    <td style="border: 1px solid black; padding: 8px;">Unpaid</td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}
        {% endfor %}

    </div>
    {% endif %} -->
</body>

</html>